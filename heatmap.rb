## one of our referees asked for us to explore the space of beta and tau. This is a great idea!
## we'll do that with an n=30 network
## first, be sure to run construct_spin.rb and simple_teacher.rb

taught=Array.new(n) { |i|
  if best_keep.include?(i) then
    equilibrium[i]
  else
    0
  end
}

## scan in tau and beta space
tau_list=Array.new(26) { |i| (i)*10.0/25.0 }
beta_list=Array.new(26) { |i| (i)*2/25.0 }

big_set=[]

tau_list.reverse.each { |tau|
  beta_list.reverse.each { |beta|

    file=File.new("DATA/node_teacher.dat", 'w')
    file.write("#{n}\n#{taught.collect { |i| i*tau }.join(" ")}")
    file.close

    n_samp=32*32*8 #*8
    hamming_list=Parallel.map(Array.new(n_samp) { nil }, :in_processes=>n_proc) {
      learned=`./CEU_ISING/ising -t DATA/node_weights.dat DATA/node_teacher.dat #{beta}`.split("\n")[0]
      current.hamming(learned.split(" "))
    }

    big_set << [tau, beta, hamming_list.mean, hamming_list.select { |i| i < 1 }.length*1.0/hamming_list.length, hamming_list.select { |i| i < 2 }.length*1.0/hamming_list.length]
    print "#{big_set[-1]}\n"
    
  }
}

## here's what I get when I run this; each line is tau, beta, average hamming distance, fraction that are perfect; fraction that are one hamming unit or less away from perfect
# [10.0, 2.0, 0.3184814453125, 0.8153076171875, 0.9862060546875]
# [10.0, 1.92, 0.2728271484375, 0.802001953125, 0.990234375]
# [10.0, 1.84, 0.28369140625, 0.7886962890625, 0.99072265625]
# [10.0, 1.76, 0.27685546875, 0.776611328125, 0.9906005859375]
# [10.0, 1.68, 0.279541015625, 0.7603759765625, 0.9912109375]
# [10.0, 1.6, 0.2852783203125, 0.7418212890625, 0.989501953125]
# [10.0, 1.52, 0.318603515625, 0.7149658203125, 0.98583984375]
# [10.0, 1.44, 0.3221435546875, 0.7017822265625, 0.9864501953125]
# [10.0, 1.36, 0.3548583984375, 0.6744384765625, 0.981201171875]
# [10.0, 1.28, 0.390869140625, 0.65087890625, 0.9725341796875]
# [10.0, 1.2, 0.432373046875, 0.6217041015625, 0.96044921875]
# [10.0, 1.12, 0.490234375, 0.588623046875, 0.9420166015625]
# [10.0, 1.04, 0.543212890625, 0.5543212890625, 0.9302978515625]
# [10.0, 0.96, 0.6292724609375, 0.509521484375, 0.9013671875]
# [10.0, 0.88, 0.7467041015625, 0.4576416015625, 0.8587646484375]
# [10.0, 0.8, 0.8876953125, 0.409912109375, 0.80419921875]
# [10.0, 0.72, 1.1063232421875, 0.328369140625, 0.7381591796875]
# [10.0, 0.64, 1.3670654296875, 0.2713623046875, 0.646484375]
# [10.0, 0.56, 1.797607421875, 0.1922607421875, 0.5198974609375]
# [10.0, 0.48, 2.45166015625, 0.1199951171875, 0.37060546875]
# [10.0, 0.4, 3.45361328125, 0.0579833984375, 0.2108154296875]
# [10.0, 0.32, 5.07275390625, 0.017333984375, 0.0826416015625]
# [10.0, 0.24, 7.428466796875, 0.001953125, 0.0150146484375]
# [10.0, 0.16, 9.9700927734375, 0.0001220703125, 0.001708984375]
# [10.0, 0.08, 11.823974609375, 0.0, 0.0001220703125]
# [10.0, 0.0, 13.0079345703125, 0.0, 0.0]
# [9.6, 2.0, 0.31982421875, 0.8087158203125, 0.9866943359375]
# [9.6, 1.92, 0.3040771484375, 0.8031005859375, 0.9874267578125]
# [9.6, 1.84, 0.3106689453125, 0.794677734375, 0.9876708984375]
# [9.6, 1.76, 0.29638671875, 0.764892578125, 0.9898681640625]
# [9.6, 1.68, 0.3023681640625, 0.75537109375, 0.9879150390625]
# [9.6, 1.6, 0.2984619140625, 0.7469482421875, 0.988037109375]
# [9.6, 1.52, 0.31640625, 0.7156982421875, 0.984375]
# [9.6, 1.44, 0.33203125, 0.7020263671875, 0.9810791015625]
# [9.6, 1.36, 0.3548583984375, 0.678466796875, 0.9798583984375]
# [9.6, 1.28, 0.408447265625, 0.6407470703125, 0.968505859375]
# [9.6, 1.2, 0.430908203125, 0.6185302734375, 0.9625244140625]
# [9.6, 1.12, 0.4808349609375, 0.5927734375, 0.943359375]
# [9.6, 1.04, 0.56005859375, 0.5406494140625, 0.9246826171875]
# [9.6, 0.96, 0.63671875, 0.5025634765625, 0.8992919921875]
# [9.6, 0.88, 0.7486572265625, 0.45556640625, 0.857177734375]
# [9.6, 0.8, 0.908447265625, 0.38818359375, 0.8056640625]
# [9.6, 0.72, 1.10302734375, 0.3338623046875, 0.7313232421875]
# [9.6, 0.64, 1.3809814453125, 0.2672119140625, 0.643798828125]
# [9.6, 0.56, 1.7906494140625, 0.1839599609375, 0.522216796875]
# [9.6, 0.48, 2.4666748046875, 0.1170654296875, 0.3753662109375]
# [9.6, 0.4, 3.479736328125, 0.055908203125, 0.2083740234375]
# [9.6, 0.32, 5.0889892578125, 0.0166015625, 0.075927734375]
# [9.6, 0.24, 7.47021484375, 0.001953125, 0.014404296875]
# [9.6, 0.16, 9.9351806640625, 0.0, 0.001220703125]
# [9.6, 0.08, 11.820068359375, 0.0, 0.0001220703125]
# [9.6, 0.0, 12.9842529296875, 0.0, 0.0]
# [9.2, 2.0, 0.371337890625, 0.8087158203125, 0.982421875]
# [9.2, 1.92, 0.3253173828125, 0.7952880859375, 0.9871826171875]
# [9.2, 1.84, 0.3341064453125, 0.78759765625, 0.9869384765625]
# [9.2, 1.76, 0.3607177734375, 0.763671875, 0.9840087890625]
# [9.2, 1.68, 0.3238525390625, 0.75732421875, 0.9874267578125]
# [9.2, 1.6, 0.315185546875, 0.7442626953125, 0.98583984375]
# [9.2, 1.52, 0.31640625, 0.72412109375, 0.9862060546875]
# [9.2, 1.44, 0.3370361328125, 0.6990966796875, 0.9837646484375]
# [9.2, 1.36, 0.350341796875, 0.6815185546875, 0.9771728515625]
# [9.2, 1.28, 0.3990478515625, 0.6478271484375, 0.96875]
# [9.2, 1.2, 0.436279296875, 0.61767578125, 0.9599609375]
# [9.2, 1.12, 0.4923095703125, 0.58251953125, 0.9476318359375]
# [9.2, 1.04, 0.5361328125, 0.5572509765625, 0.9281005859375]
# [9.2, 0.96, 0.6380615234375, 0.4976806640625, 0.899169921875]
# [9.2, 0.88, 0.756103515625, 0.4498291015625, 0.8587646484375]
# [9.2, 0.8, 0.9127197265625, 0.39208984375, 0.8031005859375]
# [9.2, 0.72, 1.10400390625, 0.3309326171875, 0.733154296875]
# [9.2, 0.64, 1.3641357421875, 0.262451171875, 0.6441650390625]
# [9.2, 0.56, 1.8316650390625, 0.1947021484375, 0.5155029296875]
# [9.2, 0.48, 2.427001953125, 0.121826171875, 0.3748779296875]
# [9.2, 0.4, 3.47314453125, 0.055908203125, 0.2142333984375]
# [9.2, 0.32, 5.0994873046875, 0.0172119140625, 0.0802001953125]
# [9.2, 0.24, 7.3575439453125, 0.0028076171875, 0.0167236328125]
# [9.2, 0.16, 9.94921875, 0.0001220703125, 0.0010986328125]
# [9.2, 0.08, 11.8299560546875, 0.0, 0.0]
# [9.2, 0.0, 13.0552978515625, 0.0, 0.0]
# [8.8, 2.0, 0.366943359375, 0.8072509765625, 0.9830322265625]
# [8.8, 1.92, 0.3848876953125, 0.7991943359375, 0.983154296875]
# [8.8, 1.84, 0.367431640625, 0.7847900390625, 0.984619140625]
# [8.8, 1.76, 0.3282470703125, 0.765869140625, 0.9879150390625]
# [8.8, 1.68, 0.31640625, 0.75732421875, 0.9869384765625]
# [8.8, 1.6, 0.346435546875, 0.7413330078125, 0.986083984375]
# [8.8, 1.52, 0.3428955078125, 0.7215576171875, 0.9835205078125]
# [8.8, 1.44, 0.3316650390625, 0.7069091796875, 0.983642578125]
# [8.8, 1.36, 0.35546875, 0.6800537109375, 0.978515625]
# [8.8, 1.28, 0.397705078125, 0.6466064453125, 0.968994140625]
# [8.8, 1.2, 0.435546875, 0.6187744140625, 0.9588623046875]
# [8.8, 1.12, 0.4898681640625, 0.580078125, 0.9468994140625]
# [8.8, 1.04, 0.558349609375, 0.5469970703125, 0.9259033203125]
# [8.8, 0.96, 0.63916015625, 0.4984130859375, 0.89697265625]
# [8.8, 0.88, 0.74462890625, 0.456787109375, 0.85986328125]
# [8.8, 0.8, 0.8978271484375, 0.3984375, 0.80615234375]
# [8.8, 0.72, 1.1031494140625, 0.3302001953125, 0.73681640625]
# [8.8, 0.64, 1.3905029296875, 0.2633056640625, 0.6387939453125]
# [8.8, 0.56, 1.833740234375, 0.1884765625, 0.5152587890625]
# [8.8, 0.48, 2.4444580078125, 0.12109375, 0.3677978515625]
# [8.8, 0.4, 3.4793701171875, 0.05908203125, 0.21337890625]
# [8.8, 0.32, 5.09423828125, 0.0184326171875, 0.08447265625]
# [8.8, 0.24, 7.392333984375, 0.0029296875, 0.013916015625]
# [8.8, 0.16, 9.970947265625, 0.0, 0.0006103515625]
# [8.8, 0.08, 11.8306884765625, 0.0, 0.0]
# [8.8, 0.0, 12.9954833984375, 0.0, 0.0]
# [8.4, 2.0, 0.439453125, 0.8021240234375, 0.9775390625]
# [8.4, 1.92, 0.4141845703125, 0.7972412109375, 0.98095703125]
# [8.4, 1.84, 0.43212890625, 0.7840576171875, 0.9793701171875]
# [8.4, 1.76, 0.3804931640625, 0.7613525390625, 0.9842529296875]
# [8.4, 1.68, 0.3695068359375, 0.7508544921875, 0.9844970703125]
# [8.4, 1.6, 0.359375, 0.737060546875, 0.984130859375]
# [8.4, 1.52, 0.3355712890625, 0.716064453125, 0.9847412109375]
# [8.4, 1.44, 0.3538818359375, 0.7088623046875, 0.9814453125]
# [8.4, 1.36, 0.36083984375, 0.6763916015625, 0.98046875]
# [8.4, 1.28, 0.38720703125, 0.653076171875, 0.971435546875]
# [8.4, 1.2, 0.4429931640625, 0.6129150390625, 0.9605712890625]
# [8.4, 1.12, 0.4810791015625, 0.59228515625, 0.9464111328125]
# [8.4, 1.04, 0.5521240234375, 0.54296875, 0.92919921875]
# [8.4, 0.96, 0.62451171875, 0.5107421875, 0.9039306640625]
# [8.4, 0.88, 0.746826171875, 0.4530029296875, 0.8619384765625]
# [8.4, 0.8, 0.8843994140625, 0.4034423828125, 0.8092041015625]
# [8.4, 0.72, 1.108642578125, 0.32958984375, 0.731201171875]
# [8.4, 0.64, 1.3839111328125, 0.2642822265625, 0.6453857421875]
# [8.4, 0.56, 1.7703857421875, 0.19140625, 0.534423828125]
# [8.4, 0.48, 2.448486328125, 0.1165771484375, 0.3741455078125]
# [8.4, 0.4, 3.452392578125, 0.0625, 0.2169189453125]
# [8.4, 0.32, 4.9864501953125, 0.02099609375, 0.0863037109375]
# [8.4, 0.24, 7.420654296875, 0.0018310546875, 0.0150146484375]
# [8.4, 0.16, 10.0333251953125, 0.0, 0.0006103515625]
# [8.4, 0.08, 11.8150634765625, 0.0, 0.0]
# [8.4, 0.0, 13.01318359375, 0.0, 0.0]
# [8.0, 2.0, 0.493408203125, 0.8060302734375, 0.9730224609375]
# [8.0, 1.92, 0.4490966796875, 0.7943115234375, 0.9783935546875]
# [8.0, 1.84, 0.4383544921875, 0.7806396484375, 0.9788818359375]
# [8.0, 1.76, 0.4407958984375, 0.7718505859375, 0.9801025390625]
# [8.0, 1.68, 0.41064453125, 0.7576904296875, 0.982421875]
# [8.0, 1.6, 0.408203125, 0.727783203125, 0.982666015625]
# [8.0, 1.52, 0.4022216796875, 0.718017578125, 0.979248046875]
# [8.0, 1.44, 0.3826904296875, 0.6981201171875, 0.980224609375]
# [8.0, 1.36, 0.3726806640625, 0.685546875, 0.9759521484375]
# [8.0, 1.28, 0.4068603515625, 0.64306640625, 0.969970703125]
# [8.0, 1.2, 0.4385986328125, 0.6240234375, 0.958251953125]
# [8.0, 1.12, 0.4744873046875, 0.5943603515625, 0.9493408203125]
# [8.0, 1.04, 0.55224609375, 0.541259765625, 0.9293212890625]
# [8.0, 0.96, 0.635009765625, 0.5013427734375, 0.902587890625]
# [8.0, 0.88, 0.736328125, 0.459716796875, 0.862548828125]
# [8.0, 0.8, 0.8912353515625, 0.3983154296875, 0.8077392578125]
# [8.0, 0.72, 1.0972900390625, 0.32861328125, 0.7420654296875]
# [8.0, 0.64, 1.391845703125, 0.256591796875, 0.63916015625]
# [8.0, 0.56, 1.8045654296875, 0.193115234375, 0.5185546875]
# [8.0, 0.48, 2.457275390625, 0.1192626953125, 0.368408203125]
# [8.0, 0.4, 3.388916015625, 0.058349609375, 0.216064453125]
# [8.0, 0.32, 5.017333984375, 0.0177001953125, 0.0838623046875]
# [8.0, 0.24, 7.3978271484375, 0.0020751953125, 0.014892578125]
# [8.0, 0.16, 9.9686279296875, 0.0, 0.0008544921875]
# [8.0, 0.08, 11.8253173828125, 0.0, 0.0]
# [8.0, 0.0, 13.00830078125, 0.0, 0.0]
# [7.6, 2.0, 0.6024169921875, 0.791015625, 0.9644775390625]
# [7.6, 1.92, 0.527099609375, 0.787841796875, 0.97216796875]
# [7.6, 1.84, 0.54052734375, 0.768798828125, 0.970947265625]
# [7.6, 1.76, 0.5084228515625, 0.7635498046875, 0.9764404296875]
# [7.6, 1.68, 0.468505859375, 0.7567138671875, 0.9801025390625]
# [7.6, 1.6, 0.447509765625, 0.7362060546875, 0.9791259765625]
# [7.6, 1.52, 0.4466552734375, 0.7110595703125, 0.977783203125]
# [7.6, 1.44, 0.3984375, 0.697509765625, 0.97900390625]
# [7.6, 1.36, 0.39111328125, 0.6815185546875, 0.9742431640625]
# [7.6, 1.28, 0.420654296875, 0.6419677734375, 0.970703125]
# [7.6, 1.2, 0.4490966796875, 0.61962890625, 0.96142578125]
# [7.6, 1.12, 0.5008544921875, 0.5787353515625, 0.9459228515625]
# [7.6, 1.04, 0.541015625, 0.5560302734375, 0.9283447265625]
# [7.6, 0.96, 0.64599609375, 0.501220703125, 0.8973388671875]
# [7.6, 0.88, 0.7181396484375, 0.464111328125, 0.87109375]
# [7.6, 0.8, 0.8876953125, 0.3997802734375, 0.806640625]
# [7.6, 0.72, 1.07177734375, 0.3450927734375, 0.7427978515625]
# [7.6, 0.64, 1.3934326171875, 0.260986328125, 0.6414794921875]
# [7.6, 0.56, 1.796142578125, 0.19580078125, 0.52392578125]
# [7.6, 0.48, 2.4537353515625, 0.1153564453125, 0.3671875]
# [7.6, 0.4, 3.4835205078125, 0.0574951171875, 0.20654296875]
# [7.6, 0.32, 5.09130859375, 0.0162353515625, 0.07958984375]
# [7.6, 0.24, 7.4681396484375, 0.0023193359375, 0.0164794921875]
# [7.6, 0.16, 9.9505615234375, 0.0, 0.0008544921875]
# [7.6, 0.08, 11.831298828125, 0.0, 0.0]
# [7.6, 0.0, 13.0108642578125, 0.0, 0.0]
# [7.2, 2.0, 0.787109375, 0.7728271484375, 0.950439453125]
# [7.2, 1.92, 0.7310791015625, 0.7799072265625, 0.957275390625]
# [7.2, 1.84, 0.645263671875, 0.7685546875, 0.9674072265625]
# [7.2, 1.76, 0.5836181640625, 0.762451171875, 0.9703369140625]
# [7.2, 1.68, 0.53466796875, 0.74462890625, 0.9732666015625]
# [7.2, 1.6, 0.4786376953125, 0.7392578125, 0.975830078125]
# [7.2, 1.52, 0.4564208984375, 0.713134765625, 0.976318359375]
# [7.2, 1.44, 0.447998046875, 0.6983642578125, 0.9744873046875]
# [7.2, 1.36, 0.453125, 0.675537109375, 0.969970703125]
# ... and so on, it takes awhile!